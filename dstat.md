# dstat
> dstat 是可以取代vmstat,iostat,netstat,ifstat的多功能软件，可以方便监控系统的状态和排除故障。
> dstat 可以让你实时查看到所有系统资源，比如磁盘io,网络io，cpu使用率，内存状态等
> dstat 以列表的形式展示数据，清晰明了。
> dstat 有导出数据到csv文件的命令，很简单地生成表格。
> dstat 基于python模块化设计，易扩展
> dstat 可以统计某个设备的信息
> 可以以不同的颜色显示不同的信息

### 安装
``` shell
yum install dstat
```

### 使用
``` shell
----total-cpu-usage---- -dsk/total- -net/total- ---paging-- ---system--
usr sys idl wai hiq siq| read  writ| recv  send|  in   out | int   csw
  1   2  96   0   0   1|  16k   88k|   0     0 | 207B  918B| 772  1437
  1   1  98   0   0   1|   0    71k| 530B 1232B|   0     0 | 309   540
  0   1  99   0   0   0|   0     0 | 286B  422B|   0     0 | 247   463
  1   1  98   0   0   0|   0     0 | 240B  644B|   0     0 | 272   475
```

### 分析
``` shell
CPU状态：CPU的使用率。这项报告更有趣的部分是显示了用户，系统和空闲部分，这更好地分析了CPU当前的使用状况。如果你看到"wait"一栏中，CPU的状态是一个高使用率值，那说明系统存在一些其它问题。当CPU的状态处在"waits"时，那是因为它正在等待I/O设备（例如内存，磁盘或者网络）的响应而且还没有收到。

磁盘统计：磁盘的读写操作，这一栏显示磁盘的读、写总数。

网络统计：网络设备发送和接受的数据，这一栏显示的网络收、发数据总数。

分页统计：系统的分页活动。分页指的是一种内存管理技术用于查找系统场景，一个较大的分页表明系统正在使用大量的交换空间，或者说内存非常分散，大多数情况下你都希望看到page in（换入）和page out（换出）的值是0 0。

系统统计：这一项显示的是中断（int）和上下文切换（csw）。这项统计仅在有比较基线时才有意义。这一栏中较高的统计值通常表示大量的进程造成拥塞，需要对CPU进行关注。你的服务器一般情况下都会运行运行一些程序，所以这项总是显示一些数值。

默认情况下，dstat每秒都会刷新数据。如果想退出dstat，你可以按"CTRL-C"键。

需要注意的是报告的第一行，通常这里所有的统计都不显示数值的。

这是由于dstat会通过上一次的报告来给出一个总结，所以第一次运行时是没有平均值和总值的相关数据。
但是dstat可以通过传递2个参数运行来控制报告间隔和报告数量。例如，如果你想要dstat输出默认监控、报表输出的时间间隔为3秒钟,并且报表中输出10个结果，你可以运行如下命令：
`dstat 3 10`
```

### 参数
```
-l ：显示负载统计量
-m ：显示内存使用率（包括used，buffer，cache，free值）
-r ：显示I/O统计
-s ：显示交换分区使用情况
-t ：将当前时间显示在第一行
–fs ：显示文件系统统计数据（包括文件总数量和inodes值）
–nocolor ：不显示颜色（有时候有用）
–socket ：显示网络统计数据
–tcp ：显示常用的TCP统计
–udp ：显示监听的UDP接口及其当前用量的一些动态数据
```
### 扩展
```
-–disk-util ：显示某一时间磁盘的忙碌状况
-–freespace ：显示当前磁盘空间使用率
-–proc-count ：显示正在运行的程序数量
-–top-bio ：指出块I/O最大的进程
-–top-cpu ：图形化显示CPU占用最大的进程
-–top-io ：显示正常I/O最大的进程
-–top-mem ：显示占用最多内存的进程
```

### 案例
```
# 查看全部内存都有谁在占用：
dstat -g -l -m -s --top-mem
# 显示一些关于CPU资源损耗的数据：
dstat -c -y -l --proc-count --top-cpu
```

### 输出到文件
```
dstat –output /tmp/sampleoutput.csv -cdn
```

[参考资料](https://linux.cn/article-3215-1.html)
